<!DOCTYPE html>
<html>
<head>
  <title>Accounts</title>
</head>
<body>
  <h2>My Accounts</h2>
  <ul id="accountList"></ul>

  <script>
    const userId = "{{ user_id }}";

    fetch(`/api/users/${userId}/accounts`)
      .then(response => {
        if (!response.ok) {
          throw new Error("Failed to fetch account data");
        }
        return response.json();
      })
      .then(accounts => {
        const accountList = document.getElementById("accountList");

        if (accounts.length === 0) {
          const noAccountsMessage = document.createElement("p");
          noAccountsMessage.textContent = "No accounts found.";
          accountList.appendChild(noAccountsMessage);
        } else {
          accounts.forEach(account => {
            const listItem = document.createElement("li");
            listItem.innerHTML = `
              <span>${account.id}</span>
              <button class="toggleBtn">View Details</button>
              <div class="accountDetails" style="display: none;">
                <p>Balance: ${account.balance}</p>
                <p>Credits: ${account.credits}</p>
                <p>On Hold: ${account.on_hold ? 'Yes' : 'No'}</p>
              </div>
            `;
            accountList.appendChild(listItem);
          });

          const toggleBtns = document.querySelectorAll(".toggleBtn");
          toggleBtns.forEach(btn => {
            btn.addEventListener("click", () => {
              const accountDetails = btn.nextElementSibling;
              accountDetails.style.display = accountDetails.style.display === "none" ? "block" : "none";
            });
          });
        }
      })
      .catch(error => {
        console.error("Error fetching accounts:", error);
      });
  </script>
</body>
</html>
